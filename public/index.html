<!DOCTYPE html>
<html lang="de">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Event Bridge Konfiguration</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <main class="container">
      <h1>Event Bridge Konfiguration</h1>
      <nav class="page-nav">
        <a class="nav-link" href="chat-log.html">Chat Log ansehen</a>
      </nav>

      <section class="integration-card">
        <header class="section-header">
          <div>
            <h2>Twitch Schnittstelle</h2>
            <p class="section-intro">
              Verbinde dein Bot-Konto mit dem Twitch Chat. Die wichtigsten Felder findest du unten, optionale
              OAuth-Daten liegen im ausklappbaren Bereich.
            </p>
          </div>
          <div class="doc-links">
            <a class="doc-link" href="https://dev.twitch.tv/docs/irc" target="_blank" rel="noopener"
              >Twitch IRC Dokumentation</a
            >
            <a
              class="doc-link"
              href="https://dev.twitch.tv/docs/authentication/getting-tokens-oauth"
              target="_blank"
              rel="noopener"
              >OAuth Leitfaden</a
            >
          </div>
        </header>

        <form id="twitch-form">
          <div class="form-grid">
            <div class="form-row">
              <label for="twitch-username">Bot Benutzername</label>
              <input id="twitch-username" name="username" placeholder="z.B. vibeCoderBot" required />
              <p class="field-hint">Der Twitch-Account, der Nachrichten senden und empfangen soll.</p>
            </div>

            <div class="form-row">
              <label for="twitch-token">OAuth Token</label>
              <div class="stacked-input">
                <input
                  id="twitch-token"
                  name="oauthToken"
                  type="password"
                  placeholder="oauth:xxxxxxxxxxxxxxxx"
                />
                <div class="button-row">
                  <button type="button" class="secondary-button" id="twitch-oauth-button">
                    Offizielles OAuth Tool öffnen
                  </button>
                  <button type="button" class="secondary-button" id="twitch-token-generator-button">
                    Twitch Token Generator testen
                  </button>
                </div>
              </div>
              <p class="field-hint">
                Du kannst wahlweise das offizielle <strong>Twitch Chat OAuth Tool</strong> (twitchapps.com/tmi) nutzen
                oder testweise den <strong>Twitch Token Generator</strong> (twitchtokengenerator.com) aufrufen. Der
                Token benötigt mindestens die Scopes <code>chat:read</code> und <code>chat:edit</code>.
              </p>
            </div>

            <div class="form-row">
              <label for="twitch-channel">Channel</label>
              <input id="twitch-channel" name="channel" placeholder="Dein Kanal ohne #" />
              <p class="field-hint">In diesem Kanal hört der Bot zu und verschickt Nachrichten.</p>
            </div>
          </div>

          <details class="details-card">
            <summary>Erweiterte Einstellungen (optional)</summary>
            <div class="details-content">
              <div class="form-row">
                <label for="twitch-clientId">Client ID</label>
                <input id="twitch-clientId" name="clientId" placeholder="Client ID deiner Twitch-App" />
                <p class="field-hint">
                  Nur erforderlich, wenn du eigene API-Anfragen planst oder Events abonnieren möchtest.
                </p>
              </div>
              <div class="form-row">
                <label for="twitch-clientSecret">Client Secret</label>
                <input
                  id="twitch-clientSecret"
                  name="clientSecret"
                  type="password"
                  placeholder="Client Secret"
                />
                <p class="field-hint">Bewahre diesen Wert sicher auf und teile ihn nicht öffentlich.</p>
              </div>
            </div>
          </details>

          <div class="form-actions">
            <button type="submit">Speichern</button>
            <button type="button" class="secondary-button" id="twitch-test">Verbindung testen</button>
            <span class="status-message" id="twitch-status" role="status" aria-live="polite"></span>
          </div>
        </form>

        <details class="info-card">
          <summary>Schnellstart &amp; hilfreiche Links</summary>
          <ol class="helper-list helper-list--ordered">
            <li>
              Logge dich mit deinem Bot-Konto ein und generiere den OAuth Token über eines der Tools oben (offiziell
              oder Twitch Token Generator zum Testen).
            </li>
            <li>Trage den Namen des Kanals ein, in dem der Bot aktiv sein soll, und speichere die Einstellungen.</li>
            <li>Nutze „Verbindung testen“, um zu prüfen, ob die gespeicherten Daten gültig wirken.</li>
          </ol>
        </details>
      </section>

      <section class="integration-card">
        <header class="section-header">
          <div>
            <h2>Minecraft Schnittstelle</h2>
            <p class="section-intro">
              Hinterlege die Zugangsdaten für deinen RCON-Server sowie den Pfad zu ausführbaren Skripten.
            </p>
          </div>
          <div class="doc-links">
            <a class="doc-link" href="https://minecraft.fandom.com/wiki/RCON" target="_blank" rel="noopener"
              >RCON Dokumentation</a
            >
          </div>
        </header>

        <form id="minecraft-form">
          <div class="form-grid form-grid--two">
            <div class="form-row">
              <label for="minecraft-host">Host</label>
              <input id="minecraft-host" name="host" placeholder="z.B. 127.0.0.1" />
              <p class="field-hint">IP oder Hostname deines Minecraft Servers.</p>
            </div>
            <div class="form-row">
              <label for="minecraft-port">RCON Port</label>
              <input
                id="minecraft-port"
                name="rconPort"
                type="number"
                min="1"
                max="65535"
                placeholder="25575"
              />
              <p class="field-hint">Standard ist 25575. Stelle sicher, dass der Port freigegeben ist.</p>
            </div>
            <div class="form-row">
              <label for="minecraft-password">RCON Passwort</label>
              <input
                id="minecraft-password"
                name="rconPassword"
                type="password"
                placeholder="Dein RCON Passwort"
              />
              <p class="field-hint">
                Das Passwort entspricht der Konfiguration in deiner <code>server.properties</code>.
              </p>
            </div>
            <div class="form-row">
              <label for="minecraft-scriptBasePath">Script Basis Pfad</label>
              <input
                id="minecraft-scriptBasePath"
                name="scriptBasePath"
                placeholder="/opt/event-skripte"
              />
              <p class="field-hint">Ordner, in dem deine Automationsskripte liegen.</p>
            </div>
          </div>
          <div class="form-actions">
            <button type="submit">Speichern</button>
            <button type="button" class="secondary-button" id="minecraft-test">Verbindung testen</button>
            <span class="status-message" id="minecraft-status" role="status" aria-live="polite"></span>
          </div>
        </form>

        <details class="info-card">
          <summary>Konfigurationshilfe</summary>
          <ul class="helper-list">
            <li>Aktiviere <code>enable-rcon=true</code> in deiner <code>server.properties</code>.</li>
            <li>Setze <code>rcon.password</code> auf ein sicheres Passwort und übernimm den Wert hier im Formular.</li>
            <li>Lege deine Skripte im angegebenen Basis-Pfad ab und stelle sicher, dass der Webserver Zugriffsrechte hat.</li>
          </ul>
        </details>
      </section>

      <section class="integration-card">
        <header class="section-header">
          <div>
            <h2>Command Mapping</h2>
            <p class="section-intro">
              Verknüpfe Chatbefehle mit Skripten auf deinem Server. Diese Zuordnung bildet die Grundlage für
              Automatisierung.
            </p>
          </div>
          <div class="doc-links">
            <a
              class="doc-link"
              href="https://minecraft.fandom.com/wiki/Commands"
              target="_blank"
              rel="noopener"
              >Übersicht Minecraft Befehle</a
            >
          </div>
        </header>

        <form id="command-form">
          <div class="form-row">
            <label for="command-command">Chat Befehl</label>
            <input id="command-command" name="command" placeholder="z.B. !start" required />
            <p class="field-hint">Der Text, den Zuschauer:innen im Chat eingeben.</p>
          </div>
          <div class="form-row">
            <label for="command-script">Script Name</label>
            <input id="command-script" name="scriptName" placeholder="z.B. start_event.sh" required />
            <p class="field-hint">Dateiname inklusive Endung. Das Skript wird relativ zum Basis-Pfad ausgeführt.</p>
          </div>
          <div class="form-row">
            <label for="command-description">Beschreibung</label>
            <input id="command-description" name="description" placeholder="Optionale Beschreibung" />
          </div>
          <div class="form-actions">
            <button type="submit">Hinzufügen / Aktualisieren</button>
            <span class="status-message" id="command-status" role="status" aria-live="polite"></span>
          </div>
        </form>

        <table id="command-table">
          <thead>
            <tr>
              <th>Chat Befehl</th>
              <th>Script</th>
              <th>Beschreibung</th>
              <th>Aktionen</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </section>
    </main>

    <template id="command-row-template">
      <tr>
        <td class="command"></td>
        <td class="script"></td>
        <td class="description"></td>
        <td>
          <button class="delete">Löschen</button>
        </td>
      </tr>
    </template>

    <script src="main.js"></script>
  </body>
</html>
